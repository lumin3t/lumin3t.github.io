<!DOCTYPE html>
<html lang="en">

    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><title>My Site</title>
<meta name="description" content="Hello, I&#39;m [redacted]">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8"/>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<link rel="stylesheet" href="http://localhost:1313/css/palettes/tokyo-night-dark.css">
<link rel="stylesheet" href="http://localhost:1313/css/risotto.css">
<link rel="stylesheet" href="http://localhost:1313/css/custom.css">







</head>

    <body>
        <div class="page">

            <header class="page__header"><nav class="page__nav main-nav">
    <ul>
    <h1 class="page__logo"><a href="http://localhost:1313/" class="page__logo-inner">My Site</a></h1>
    
    
    <li class="main-nav__item"><a class="nav-main-item" href="http://localhost:1313/about/" title="">About</a></li>
    
    <li class="main-nav__item"><a class="nav-main-item" href="http://localhost:1313/notes" title="">Notes</a></li>
    
    <li class="main-nav__item"><a class="nav-main-item" href="http://localhost:1313/posts" title="">Posts</a></li>
    
    </ul>
</nav>

</header>

            <section class="page__body">
    <header class="content__header">
        <h1></h1>
    </header>
    <div class="content__body">
        <p><strong>1) Host-Centric Log Sources</strong></p>
<p>These are log sources that capture events that occurred within or related to the host. Some log sources that generate host-centric logs are Windows Event logs, Sysmon, Osquery, etc. Some examples of host-centric logs are:</p>
<ul>
<li>A user accessing a file</li>
<li>A user attempting to authenticate.</li>
<li>A process Execution Activity</li>
<li>A process adding/editing/deleting a registry key or value.</li>
<li>Powershell execution</li>
</ul>
<p><strong>2) Network-Centric Log Sources</strong></p>
<p>Network-related logs are generated when the hosts communicate with each other or access the internet to visit a website. Some network-based protocols are SSH, VPN, HTTP/s, FTP, etc. Examples of such events are:</p>
<ul>
<li>SSH connection</li>
<li>A file being accessed via FTP</li>
<li>Web traffic</li>
<li>A user accessing company&rsquo;s resources through VPN.</li>
<li>Network file sharing Activity</li>
</ul>
<p>so.. SIEM</p>
<ul>
<li>Real-time log Ingestion</li>
<li>Alerting against abnormal activities</li>
<li>24/7 Monitoring and visibility</li>
<li>Protection against the latest threats through early detection</li>
<li>Data Insights and visualization</li>
<li>Ability to investigate past incidents.</li>
</ul>
<p>Windows: Event Viewer
Linux:</p>
<ul>
<li>/var/log/httpd : Contains HTTP Request  / Response and error logs.</li>
<li>/var/log/cron   : Events related to cron jobs are stored in this location.</li>
<li>/var/log/auth.log and /var/log/secure : Stores authentication related logs.</li>
<li>/var/log/kern : This file stores kernel related events.</li>
</ul>
<p>web server logs:
 /var/log/apache or /var/log/httpd.</p>
<h4 id="log-ingestion">Log ingestion</h4>
<ul>
<li>port forwarding -  SIEM solutions listen on a certain port, endpoints forward the data to the SIEM instance on the listening port.</li>
<li>uploading offline files for analysis</li>
<li>syslog -  Syslog protocol data from web servers, databases, etc., eal-time data to centralized destination.</li>
<li>agent/forwarder: lightweight tool called an agent (forwarder by Splunk) that gets installed in the Endpoint. configured to capture all the important logs and send them to the SIEM server.</li>
</ul>
<h4 id="correlation-rules">Correlation rules</h4>
<ul>
<li>If a User gets 5 failed Login Attempts in 10 seconds - Raise an alert for <code>Multiple Failed Login Attempts</code></li>
<li>If login is successful after multiple failed login attempts - Raise an alert for <code>Successful Login After multiple Login Attempts</code></li>
<li>A rule is set to alert every time a user plugs in a USB (Useful if USB is restricted as per the company policy)</li>
<li>If outbound traffic is &gt; 25 MB - Raise an alert to potential Data exfiltration Attempt (Usually, it depends on the company policy)</li>
<li><code>Event Log Cleared</code></li>
<li> <code>WHOAMI command Execution DETECTED</code></li>
</ul>
<p> Correlation rules keep an eye on the values of certain fields to get triggered. That is the reason why it is important to have normalized logs ingested.</p>
<h4 id="alert-investigation">Alert investigation</h4>
<ul>
<li>Alert is False Alarm. It may require tuning the rule to avoid similar False positives from occurring again.</li>
<li>Alert is True Positive. Perform further investigation.</li>
<li>Contact the asset owner to inquire about the activity.</li>
<li>Suspicious activity is confirmed. Isolate the infected host.</li>
<li>Block the suspicious IP.</li>
</ul>
<p>Alert &ldquo;Potential CryptoMiner Activity&rdquo; If EventID = 4688 AND Log_Source = WindowsEventLogs AND ProcessName = (<em>miner</em> OR <em>crypt</em>)</p>
<ul>
<li><a href="https://tryhackme.com/room/jrsecanalystintrouxo">Jr. SOC Analyst</a></li>
<li><a href="https://tryhackme.com/room/splunk101">Splunk101</a></li>
<li><a href="https://tryhackme.com/room/splunk201">Splunk201</a></li>
<li><a href="https://tryhackme.com/room/benign">Benign</a></li>
<li><a href="https://tryhackme.com/room/investigatingwithsplunk">InvestigatingwithSplunk</a></li>
<li><a href="https://tryhackme.com/room/investigatingwithelk101">InvestgatingwithELK</a></li>
<li><a href="https://tryhackme.com/room/itsybitsy">ItsyBitsy</a></li>
</ul>

    </div>
    <footer class="content__footer"></footer>

            </section>

            <section class="page__aside">
                <div class="aside__about">
<div class="aside__about">
    
<h1 class="about__title">:&gt; Ibha</h1>
<p class="about__description">Hello, I&rsquo;m [redacted]</p>
</div>


<ul class="aside__social-links">
    
    <li>
        <a href="https://github.com/lumin3t" rel="me" aria-label="GitHub" title="GitHub"><i class="fa-brands fa-github" aria-hidden="true"></i></a>&nbsp;
    </li>
    
    <li>
        <a href="mailto:surgeoffrost@proton.me" rel="me" aria-label="Email" title="Email"><i class="fa-solid fa-envelope" aria-hidden="true"></i></a>&nbsp;
    </li>
    
    <li>
        <a href="https://dev.to/luminet" rel="me" aria-label="Dev.to" title="Dev.to"><i class="ai ai-orcid" aria-hidden="true"></i></a>&nbsp;
    </li>
    
    <li>
        <a href="https://tryhackme.com/luminet" rel="me" aria-label="TryHackMe" title="TryHackMe"><i class="fa-sharp fa-solid fa-cloud" aria-hidden="true"></i></a>&nbsp;
    </li>
    
</ul>
</div>
                <hr>
                <div class="aside__content">
    
    

    

                </div>
            </section>

            <footer class="page__footer"><p>
    
    
    
    
    
    
      
    
      
    
      
    
    
    
      
      
          
            
            
                <br/><span class="active">$ echo $LANG<br/><b></b></span><br/>

            
          
      
    
</p>
<br /><br />
<p class="copyright"></p>
<p class="advertisement">Powered by <a href="https://gohugo.io/">hugo</a> and <a href="https://github.com/joeroe/risotto">risotto</a>.</p>
</footer>

        </div>
    </body>

</html>
